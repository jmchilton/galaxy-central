(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{a(jQuery)}}(function(c){function j(m,n){n=n||((!_.isEmpty(m))?(m[0]):(""));var l=c(['<div class="dropdown-select btn-group">','<button type="button" class="btn btn-default">','<span class="dropdown-select-selected">'+n+"</span>","</button>","</div>"].join("\n"));if(m&&m.length>1){l.find("button").addClass("dropdown-toggle").attr("data-toggle","dropdown").append(' <span class="caret"></span>');l.append(['<ul class="dropdown-menu" role="menu">',_.map(m,function(p){return['<li><a href="javascript:void(0)">',p,"</a></li>"].join("")}).join("\n"),"</ul>"].join("\n"))}function o(r){var s=c(this),q=s.parents(".dropdown-select"),p=s.text();q.find(".dropdown-select-selected").text(p);q.trigger("change.dropdown-select",p)}l.find("a").click(o);return l}function f(m,l){return this.init(m,l)}f.prototype.DATA_KEY="filter-control";f.prototype.init=function i(m,l){l=l||{filters:[]};this.$element=c(m).addClass("filter-control btn-group");this.options=jQuery.extend(true,{},this.defaults,l);this.currFilter=this.options.filters[0];return this.render()};f.prototype.render=function e(){this.$element.empty().append([this._renderKeySelect(),this._renderOpSelect(),this._renderValueInput()]);return this};f.prototype._renderKeySelect=function a(){var l=this;var m=this.options.filters.map(function(n){return n.key});this.$keySelect=j(m,this.currFilter.key).addClass("filter-control-key").on("change.dropdown-select",function(o,n){l.currFilter=_.findWhere(l.options.filters,{key:n});l.render()._triggerChange()});return this.$keySelect};f.prototype._renderOpSelect=function k(){var l=this,m=this.currFilter.ops;this.$opSelect=j(m,m[0]).addClass("filter-control-op").on("change.dropdown-select",function(o,n){l._triggerChange()});return this.$opSelect};f.prototype._renderValueInput=function d(){var l=this;if(this.currFilter.values){this.$valueSelect=j(this.currFilter.values,this.currFilter.values[0]).on("change.dropdown-select",function(n,m){l._triggerChange()})}else{this.$valueSelect=c("<input/>").addClass("form-control").on("change",function(m,n){l._triggerChange()})}this.$valueSelect.addClass("filter-control-value");return this.$valueSelect};f.prototype.val=function b(){var m=this.$element.find(".filter-control-key .dropdown-select-selected").text(),o=this.$element.find(".filter-control-op .dropdown-select-selected").text(),l=this.$element.find(".filter-control-value"),n=(l.hasClass("dropdown-select"))?(l.find(".dropdown-select-selected").text()):(l.val());return{key:m,op:o,value:n}};f.prototype._triggerChange=function h(){this.$element.trigger("change.filter-control",this.val())};jQuery.fn.extend({filterControl:function g(m){var l=jQuery.makeArray(arguments).slice(1);return this.map(function(){var p=c(this),o=p.data(f.prototype.DATA_KEY);if(jQuery.type(m)==="object"){o=new f(p,m);p.data(f.prototype.DATA_KEY,o)}if(o&&jQuery.type(m)==="string"){var n=o[m];if(jQuery.type(n)==="function"){return n.apply(o,l)}}return this})}})}));